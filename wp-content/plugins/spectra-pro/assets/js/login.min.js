UAGBLogin={settings:{},loginButtonInnerElement:"",spinner:`<svg width="20" height="20" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#fff">
		<g fill="none" fill-rule="evenodd">
			<g transform="translate(1 1)" stroke-width="2">
				<circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
				<path d="M36 18c0-9.94-8.06-18-18-18">
					<animateTransform
						attributeName="transform"
						type="rotate"
						from="0 18 18"
						to="360 18 18"
						dur="1s"
						repeatCount="indefinite"/>
				</path>
			</g>
		</g>
	</svg>`,classes:{inputError:"spectra-pro-login-form__input-error",fieldErrorMessage:"spectra-pro-login-form__field-error-message"},init(e,t,r={}){this._listenLogoutRedirect(r),this.settings[t]=r,this.getElements(e)&&(this.validateOnEntry(e,r?.this_field_error_msg),this.passwordVisibility(e,t),r.enableReCaptcha&&this.reCaptcha(t,r),this.formSubmitInit(e,t,r.enableReCaptcha,r.recaptchaVersion,r?.this_field_error_msg),this.forgotPasswordInit(e,t))},forgotPasswordInit(e,t){var r=document.querySelector(e+" .spectra-pro-login-form-forgot-password > a"),s=this.settings[t];const o=document.querySelector(t+" .spectra-pro-login-form-status"),i=UAGBLogin.getElements(e);let a=new FormData;a.append("action","spectra_pro_block_login_forgot_password");const n=this.processAjaxUrl(s.ajax_url);r?.addEventListener("click",function(){let e=UAGBLogin.serializeArrayJS(i);for(const t in e=e.reduce((e,{name:t,value:r})=>(e[t]=r,e),{}))a.append(t,e[t]);fetch(n,{method:"POST",credentials:"same-origin",body:a}).then(e=>e.json()).then(t=>{if(o)if(t.success)o.innerHTML=`<div class="spectra-pro-login-form-status__success">${t.data}</div>`;else if("custom"===t.data.type)o.innerHTML=`<div class="spectra-pro-login-form-status__error-item">${t.data.message}</div>`;else{let e="";if(t?.data&&"object"==typeof t.data&&0<Object.keys(t.data).length)for(const r of t.data)e+=`<div class="spectra-pro-login-form-status__error-item">${r.message}</div>`;o.innerHTML=e||`<div class="spectra-pro-login-form-status__error">${JSON.stringify(t.data).replace(/\\"/g,"'")}</div>`}}).catch(e=>{})})},_validateFields(e,t){switch(e.name){case"username":""===e.value.trim()?this._setStatus(e,t.username,"error"):this._setStatus(e,null,"success");break;case"password":""===e.value.trim()?this._setStatus(e,t.password,"error"):this._setStatus(e,null,"success")}},_setStatus(e,t,r){var s=e.parentElement.querySelector(".spectra-pro-login-form__field-error-message");"success"===r&&(s&&s.remove(),e.classList.remove(UAGBLogin.classes.inputError)),"error"===r&&(e.classList.add(UAGBLogin.classes.inputError),s?s.innerHTML=t:((r=document.createElement("span")).classList="spectra-pro-login-form__field-error-message",r.innerHTML=t,e.parentElement.appendChild(r)))},_isFormSubmitable(e){return UAGBLogin.getElements(e).getElementsByClassName(UAGBLogin.classes.inputError).length<1},_showValidationMessage(e,t){const s=UAGBLogin.getElements(e);Object.entries(t).forEach(([e,t])=>{var r=document.createElement("span");r.classList="spectra-pro-login-form__field-error-message",r.innerHTML=t,s.querySelector('input[name="'+e+'"]')?.parentElement().append(r)})},_dispatchLoginRedirect(e){window.location.href=e.loginRedirectURL},_listenLogoutRedirect(e){var t=".uagb-block-"+e.block_id,t=document.querySelector(t+" .wp-block-spectra-pro-login__logged-in-message a"),r=this._sameOrigin(window.location,e.logoutRedirectURL);t&&!r&&t.addEventListener("click",()=>{window.open(e.logoutRedirectURL)})},_sameOrigin(e,t){e=new URL(e),t=new URL(t);return e.origin===t.origin},_formSubmit(e,t,r=!1){const s=this.settings[t],o=document.querySelector(t+" .spectra-pro-login-form-submit-button"),i=document.querySelector(t+" .spectra-pro-login-form-status"),a=UAGBLogin.getElements(e);let n=this.serializeArrayJS(a);n=n.reduce((e,{name:t,value:r})=>(e[t]=r,e),{}),s.enableReCaptcha&&(n.recaptchaStatus=s.enableReCaptcha,n.reCaptchaType=s.recaptchaVersion,r)&&(n["g-recaptcha-response"]=r);var c=new FormData;c.append("action","spectra_pro_block_login");for(const l in n)c.append(l,n[l]);a.style.opacity="0.45",o.setAttribute("disabled","disabled"),UAGBLogin.loginButtonInnerElement=o.innerHTML,o.innerHTML=UAGBLogin.spinner,i.innerHTML="";t=a.querySelector("."+UAGBLogin.classes.fieldErrorMessage),t&&t.remove(),r=this.processAjaxUrl(s.ajax_url);fetch(r,{method:"POST",credentials:"same-origin",body:c}).then(e=>e.json()).then(t=>{if(t.success)i.innerHTML=`<div class="spectra-pro-login-form-status__success">${t.data}</div>`;else{let e="";if(t?.data&&"object"==typeof t.data&&0<Object.keys(t.data).length)for(const r of t.data)e+=`<div class="spectra-pro-login-form-status__error-item">${r}</div>`;i.innerHTML=e||`<div class="spectra-pro-login-form-status__error">${JSON.stringify(t.data).replace(/\\"/g,"'")}</div>`}setTimeout(()=>{a.style.opacity="1",o.innerHTML=UAGBLogin.loginButtonInnerElement,o.removeAttribute("disabled"),t.success?UAGBLogin._dispatchLoginRedirect(s):UAGBLogin._showValidationMessage(e,t.data)},1e3)}).catch(e=>{})},getElements(e,t=null){let r=document.querySelector(e);if(r){if(t)return r.querySelector(t)}else{var s=document.querySelector('iframe[name="editor-canvas"]');if(s&&s.contentDocument&&(r=s.contentDocument.querySelector(e),t))return r=r.querySelector(t)}return r},getFormFields(e){return UAGBLogin.getElements(e).querySelectorAll("input:not([type=hidden])")},validateOnEntry(e,t){const r=this;for(const s of this.getFormFields(e))s.addEventListener("focusout",()=>{r._validateFields(s,t)})},reCaptcha(e,t){var r;"v2"===t.recaptchaVersion&&UAGBLogin.settings[e].recaptchaSiteKey?((r=document.createElement("script")).type="text/javascript",r.src="https://www.google.com/recaptcha/api.js",document.head.appendChild(r)):"v3"===t.recaptchaVersion&&UAGBLogin.settings[e].recaptchaSiteKey&&((r=document.createElement("script")).type="text/javascript",r.src="https://www.google.com/recaptcha/api.js?render="+t.recaptchaSiteKey,document.head.appendChild(r))},formSubmitInit(r,s,o,i,a){const n=this.getFormFields(r);document.querySelector(r).addEventListener("submit",function(e){e.preventDefault();for(const t of n)UAGBLogin._validateFields(t,a);UAGBLogin._isFormSubmitable(r)&&(!0===o&&"v3"===i?grecaptcha.ready(function(){grecaptcha.execute(UAGBLogin.settings[s].recaptchaSiteKey,{action:"submit"}).then(function(e){UAGBLogin._formSubmit(r,s,e)})}):UAGBLogin._formSubmit(r,s))})},passwordVisibility(e,r){function t(e){var t=document.querySelector(r+" .spectra-pro-login-form-pass-wrap button");t.querySelector(".dashicons").classList.remove(e?"dashicons-hidden":"dashicons-visibility"),t.querySelector(".dashicons").classList.add(e?"dashicons-visibility":"dashicons-hidden")}UAGBLogin.getElements(e).querySelector("#password-visibility-"+UAGBLogin.settings[r].block_id).addEventListener("click",function(){var e=document.querySelector(r+" .spectra-pro-login-form-pass-wrap input");"password"===e.getAttribute("type")?(e.setAttribute("type","text"),t(!1)):(e.setAttribute("type","password"),t(!0))})},serializeArrayJS(e){let r=[];return Array.prototype.slice.call(e.elements).forEach(function(t){!t.name||t.disabled||-1<["file","reset","submit","button"].indexOf(t.type)||("select-multiple"===t.type?Array.prototype.slice.call(t.options).forEach(function(e){e.selected&&r.push({name:t.name,value:e.value})}):-1<["checkbox","radio"].indexOf(t.type)&&!t.checked||r.push({name:t.name,value:t.value}))}),r},processAjaxUrl(e){e=new URL(e);return e.protocol!==window.location.protocol&&(e.protocol=window.location.protocol),e}};