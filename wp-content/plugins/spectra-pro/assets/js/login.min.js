UAGBLogin={settings:{},loginButtonInnerElement:"",spinner:`<svg width="20" height="20" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#fff">
		<g fill="none" fill-rule="evenodd">
			<g transform="translate(1 1)" stroke-width="2">
				<circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
				<path d="M36 18c0-9.94-8.06-18-18-18">
					<animateTransform
						attributeName="transform"
						type="rotate"
						from="0 18 18"
						to="360 18 18"
						dur="1s"
						repeatCount="indefinite"/>
				</path>
			</g>
		</g>
	</svg>`,classes:{inputError:"spectra-pro-login-form__input-error",fieldErrorMessage:"spectra-pro-login-form__field-error-message"},init(e,t,r={}){this._listenLogoutRedirect(r),this.settings[t]=r,this.getElements(e)&&(this.validateOnEntry(e),this.passwordVisibility(e,t),r.enableReCaptcha&&this.reCaptcha(t,r),this.formSubmitInit(e,t,r.enableReCaptcha,r.recaptchaVersion),this.forgotPasswordInit(e,t))},forgotPasswordInit(e,t){var r=document.querySelector(e+" .spectra-pro-login-form-forgot-password > a"),o=this.settings[t];const s=document.querySelector(t+" .spectra-pro-login-form-status"),i=UAGBLogin.getElements(e);let n=new FormData;n.append("action","spectra_pro_block_login_forgot_password");const a=this.processAjaxUrl(o.ajax_url);r?.addEventListener("click",function(){let e=UAGBLogin.serializeArrayJS(i);for(const t in e=e.reduce((e,{name:t,value:r})=>(e[t]=r,e),{}))n.append(t,e[t]);fetch(a,{method:"POST",credentials:"same-origin",body:n}).then(e=>e.json()).then(t=>{if(s)if(t.success)s.innerHTML=`<div class="spectra-pro-login-form-status__success">${t.data}</div>`;else if("custom"===t.data.type)s.innerHTML=`<div class="spectra-pro-login-form-status__error-item">${t.data.message}</div>`;else{let e="";if(t?.data&&"object"==typeof t.data&&0<Object.keys(t.data).length)for(const r of t.data)e+=`<div class="spectra-pro-login-form-status__error-item">${r.message}</div>`;s.innerHTML=e||`<div class="spectra-pro-login-form-status__error">${JSON.stringify(t.data).replace(/\\"/g,"'")}</div>`}}).catch(e=>{})})},_validateFields(e){""===e.value.trim()?this._setStatus(e,e.parentElement.previousElementSibling.innerText+" cannot be blank","error"):this._setStatus(e,null,"success")},_setStatus(e,t,r){var o=e.parentElement.querySelector(".spectra-pro-login-form__field-error-message");"success"===r&&(o&&o.remove(),e.classList.remove(UAGBLogin.classes.inputError)),"error"===r&&(e.classList.add(UAGBLogin.classes.inputError),o?o.innerHTML=t:((r=document.createElement("span")).classList="spectra-pro-login-form__field-error-message",r.innerHTML=t,e.parentElement.appendChild(r)))},_isFormSubmitable(e){return UAGBLogin.getElements(e).getElementsByClassName(UAGBLogin.classes.inputError).length<1},_showValidationMessage(e,t){const o=UAGBLogin.getElements(e);Object.entries(t).forEach(([e,t])=>{var r=document.createElement("span");r.classList="spectra-pro-login-form__field-error-message",r.innerHTML=t,o.querySelector('input[name="'+e+'"]')?.parentElement().append(r)})},_dispatchLoginRedirect(e){window.location.href=e.loginRedirectURL},_listenLogoutRedirect(e){var t=".uagb-block-"+e.block_id,t=document.querySelector(t+" .wp-block-spectra-pro-login__logged-in-message a"),r=this._sameOrigin(window.location,e.logoutRedirectURL);t&&!r&&t.addEventListener("click",()=>{window.open(e.logoutRedirectURL)})},_sameOrigin(e,t){e=new URL(e),t=new URL(t);return e.origin===t.origin},_formSubmit(e,t,r=!1){const o=this.settings[t],s=document.querySelector(t+" .spectra-pro-login-form-submit-button"),i=document.querySelector(t+" .spectra-pro-login-form-status"),n=UAGBLogin.getElements(e);let a=this.serializeArrayJS(n);a=a.reduce((e,{name:t,value:r})=>(e[t]=r,e),{}),o.enableReCaptcha&&(a.recaptchaStatus=o.enableReCaptcha,a.reCaptchaType=o.recaptchaVersion,r)&&(a["g-recaptcha-response"]=r);var c=new FormData;c.append("action","spectra_pro_block_login");for(const l in a)c.append(l,a[l]);n.style.opacity="0.45",s.setAttribute("disabled","disabled"),UAGBLogin.loginButtonInnerElement=s.innerHTML,s.innerHTML=UAGBLogin.spinner,i.innerHTML="";t=n.querySelector("."+UAGBLogin.classes.fieldErrorMessage),t&&t.remove(),r=this.processAjaxUrl(o.ajax_url);fetch(r,{method:"POST",credentials:"same-origin",body:c}).then(e=>e.json()).then(t=>{if(t.success)i.innerHTML=`<div class="spectra-pro-login-form-status__success">${t.data}</div>`;else{let e="";if(t?.data&&"object"==typeof t.data&&0<Object.keys(t.data).length)for(const r of t.data)e+=`<div class="spectra-pro-login-form-status__error-item">${r}</div>`;i.innerHTML=e||`<div class="spectra-pro-login-form-status__error">${JSON.stringify(t.data).replace(/\\"/g,"'")}</div>`}setTimeout(()=>{n.style.opacity="1",s.innerHTML=UAGBLogin.loginButtonInnerElement,s.removeAttribute("disabled"),t.success?UAGBLogin._dispatchLoginRedirect(o):UAGBLogin._showValidationMessage(e,t.data)},1e3)}).catch(e=>{})},getElements(e,t=null){let r=document.querySelector(e);if(r){if(t)return r.querySelector(t)}else{var o=document.querySelector('iframe[name="editor-canvas"]');if(o&&o.contentDocument&&(r=o.contentDocument.querySelector(e),t))return r=r.querySelector(t)}return r},getFormFields(e){return UAGBLogin.getElements(e).querySelectorAll("input:not([type=hidden])")},validateOnEntry(e){const t=this;for(const r of this.getFormFields(e))r.addEventListener("focusout",()=>{t._validateFields(r)})},reCaptcha(e,t){var r;"v2"===t.recaptchaVersion&&UAGBLogin.settings[e].recaptchaSiteKey?((r=document.createElement("script")).type="text/javascript",r.src="https://www.google.com/recaptcha/api.js",document.head.appendChild(r)):"v3"===t.recaptchaVersion&&UAGBLogin.settings[e].recaptchaSiteKey&&((r=document.createElement("script")).type="text/javascript",r.src="https://www.google.com/recaptcha/api.js?render="+t.recaptchaSiteKey,document.head.appendChild(r))},formSubmitInit(r,o,s,i){const n=this.getFormFields(r);document.querySelector(r).addEventListener("submit",function(e){e.preventDefault();for(const t of n)UAGBLogin._validateFields(t);UAGBLogin._isFormSubmitable(r)&&(!0===s&&"v3"===i?grecaptcha.ready(function(){grecaptcha.execute(UAGBLogin.settings[o].recaptchaSiteKey,{action:"submit"}).then(function(e){UAGBLogin._formSubmit(r,o,e)})}):UAGBLogin._formSubmit(r,o))})},passwordVisibility(e,r){function t(e){var t=document.querySelector(r+" .spectra-pro-login-form-pass-wrap button");t.querySelector(".dashicons").classList.remove(e?"dashicons-hidden":"dashicons-visibility"),t.querySelector(".dashicons").classList.add(e?"dashicons-visibility":"dashicons-hidden")}UAGBLogin.getElements(e).querySelector("#password-visibility-"+UAGBLogin.settings[r].block_id).addEventListener("click",function(){var e=document.querySelector(r+" .spectra-pro-login-form-pass-wrap input");"password"===e.getAttribute("type")?(e.setAttribute("type","text"),t(!1)):(e.setAttribute("type","password"),t(!0))})},serializeArrayJS(e){let r=[];return Array.prototype.slice.call(e.elements).forEach(function(t){!t.name||t.disabled||-1<["file","reset","submit","button"].indexOf(t.type)||("select-multiple"===t.type?Array.prototype.slice.call(t.options).forEach(function(e){e.selected&&r.push({name:t.name,value:e.value})}):-1<["checkbox","radio"].indexOf(t.type)&&!t.checked||r.push({name:t.name,value:t.value}))}),r},processAjaxUrl(e){e=new URL(e);return e.protocol!==window.location.protocol&&(e.protocol=window.location.protocol),e}};