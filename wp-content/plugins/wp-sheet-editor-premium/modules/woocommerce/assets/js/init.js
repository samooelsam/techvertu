function vgseWcRegularPriceDecreaseNumberFormula(e){var a=vgseGenerateDecreaseFormula(e);return!!a&&a.replace("..",".").replace(/\$current_value\$/g,"$_regular_price$")}function vgseWcRegularPriceDecreasePercentageFormula(e){var a=vgseGenerateDecreasePercentageFormula(e);return!!a&&a.replace("..",".").replace(/\$current_value\$/g,"$_regular_price$")}jQuery(document).ready(function(){jQuery(document).on("opened",".remodal.custom-modal-editor",function(){var e=window.vgseWCAttsCurrent;if(!e||"vgse_save_download_files"!==e.modalSettings.edit_modal_save_action)return!0;jQuery(".remodal.custom-modal-editor .vgse-copy-files-from-product-wrapper").remove()}),jQuery(document).on("opened",".remodal.custom-modal-editor",function(){var a=window.vgseWCAttsCurrent;if(!a||"vgse_save_download_files"!==a.modalSettings.edit_modal_save_action)return!0;setTimeout(function(){$modal=jQuery(".remodal.custom-modal-editor");var e=$modal.find(".vgse-copy-files-from-product");$modal.find(".vgse-copy-files-from-product-trigger").on("click",function(){if(!e.val())return!0;loading_ajax({estado:!0}),jQuery.get(vgse_global_data.ajax_url,{nonce:e.data("nonce"),product_id:e.val(),action:"vgse_wc_get_downloadable_files"},function(e){e.success?initHandsontableForPopup(e.data,a.modalSettings):notification({mensaje:e.data.message,tipo:"error",tiempo:3e4}),loading_ajax({estado:!1})})})},400)})}),jQuery(document).ready(function(){jQuery("body").on("change",'input[name="copy_individual_variations"]',function(e){var a=jQuery(".vgse-copy-variation-from-product").val();jQuery(this).is(":checked")&&a&&(loading_ajax(!0),jQuery(".individual-variations-select").empty(),jQuery(".individual-variations-selector-wrapper").show(),jQuery.get(vgse_global_data.ajax_url,{action:"vgse_get_product_variations",nonce:jQuery(".remodal-bg").data("nonce"),product_id:a},function(e){loading_ajax(!1),e.success?e.data.length?e.data.forEach(function(e){jQuery(".individual-variations-select").append('<option value="'+e.ID+'">'+e.post_title+"</option>")}):alert(vgse_editor_settings.texts.product_without_variations):alert(e.data.message),vgseInitSelect2(jQuery(".individual-variations-select"))}))}),jQuery("body").on("change",".vgse-copy-variation-from-product",function(e){var a=jQuery(this).val(),t=jQuery(".link-variations-attributes, .link-variations-number");a?(t.parents("li").hide(),jQuery(".individual-variations-wrapper").show()):(t.parents("li").show(),jQuery(".individual-variations-wrapper").hide())}),jQuery("body").on("change",".link-variations-attributes",function(e){var a=jQuery(".link-variations-number");jQuery(this).is(":checked")?a.parents("li").hide():a.parents("li").show()}),jQuery("body").on("submit",".create-variation-modal form",function(e){var i=jQuery(this),o=jQuery(".vgse-variations-tool:visible");if("search"===i.find('select[name="vgse_variation_manager_source"]').val()&&!i.find('input[name="use_search_query"]:checked').length)return i.find('input[name="use_search_query"]').css("border","1px solid red"),!0;if(i.find('input[name="wpse_job_id"]').val(vgseGuidGenerator()),"individual"===o.find('select[name="vgse_variation_manager_source"]').val()&&(2<o.find(".individual-product-selector").val().length||"copy"===o.find('input[name="vgse_variation_tool"]').val())){o.find('select[name="vgse_variation_manager_source"]').val("search");var n=jQuery("body").data("be-filters"),a=[];o.find(".individual-product-selector").val().forEach(function(e){a.push(e.split("--")[1])}),jQuery("body").data("be-filters",{post__in:a.join(",")});var s=a.length,d=!0}else s=jQuery(".be-total-rows").text().match(/\d+/g).map(Number),d=!1;o.data("isPaginatedIndividualProductsOperation",d),"search"!==o.find('select[name="vgse_variation_manager_source"]').val()&&!i.find('input[name="use_search_query"]:checked').length||"function"!=typeof beGetRowsFilters||i.find('input[name="filters"]').val(beGetRowsFilters());var t=i.find("input,select,textarea").filter(function(){return jQuery(this).parents(".vgse-variations-tool").length&&jQuery(this).parents(".vgse-variations-tool").is(":visible")||!jQuery(this).parents(".vgse-variations-tool").length}).serializeArray();if("search"===o.find('select[name="vgse_variation_manager_source"]').val()||i.find('input[name="use_search_query"]:checked').length||"copy"===o.find('input[name="vgse_variation_tool"]').val()){loading_ajax({estado:!1});var c=o.find(".response");c.before('<div id="be-variations-nanobar-container" />');var r={classname:"be-progress-bar",target:document.getElementById("be-variations-nanobar-container")},l=new Nanobar(r);l.go(1);var u=vgse_editor_settings.save_posts_per_page/2;u<1&&(u=1);var v="copy"===o.find('input[name="vgse_variation_tool"]').val()?vgse_editor_settings.texts.paged_copy_variations_preparation:vgse_editor_settings.texts.paged_batch_saved;if("copy"===o.find('input[name="vgse_variation_tool"]').val()){var p=(p=v.replace("{updated}",0)).replace("{total}",s);jQuery(c).empty().append("<p>"+p+"</p>")}var g=0;window.wpseCreateVariationsLoop=beAjaxLoop({totalCalls:Math.ceil(s/parseInt(u)),url:i.attr("action"),method:i.attr("method"),data:t,onSuccess:function(e,a){if(loading_ajax({estado:!1}),!0===e.success||e.data||(e={data:{message:vgse_editor_settings.texts.http_error_try_now},success:!1}),!e.success)return jQuery(c).append("<p>"+e.data.message+"</p>"),confirm(e.data.message)?(a.current=0,c.scrollTop(c[0].scrollHeight),!0):(jQuery(c).append(vgse_editor_settings.texts.saving_stop_error),c.scrollTop(c[0].scrollHeight),d&&n&&(jQuery("body").data("be-filters",""),jQuery("body").data("be-filters",n)),!1);e.data.force_complete&&(a.current=a.totalCalls),e.data.deleted.length&&vgseRemoveRowFromSheetByID(e.data.deleted),l.go(a.current/a.totalCalls*100);var t=parseInt(u)*a.current>s?s:parseInt(u)*a.current,r=(r=v.replace("{updated}",t)).replace("{total}",s);return jQuery(c).empty().append("<p>"+r+"</p>"),g+=e.data.variations_count,a.current===a.totalCalls&&("copy"===o.find('input[name="vgse_variation_tool"]').val()?function(e,r,a){loading_ajax({estado:!1});var i=a.find(".response"),o=a.parents("form");o.find("#be-variations-nanobar-container").remove(),i.before('<div id="be-variations-nanobar-container" />');var t={classname:"be-progress-bar",target:document.getElementById("be-variations-nanobar-container")},n=new Nanobar(t);n.go(1);var s=vgse_editor_settings.wc_products_variation_copy_batch_size;s<1&&(s=1);var d=0;window.wpseCopyVariationsQueueLoop=beAjaxLoop({totalCalls:Math.ceil(r/parseInt(s)),url:a.parents("form").attr("action"),method:a.parents("form").attr("method"),data:{action:"vgse_process_copy_variations_queue",nonce:vgse_editor_settings.nonce,wpse_job_id:e},onSuccess:function(e,a){if(loading_ajax({estado:!1}),!0===e.success||e.data||(e={data:{message:vgse_editor_settings.texts.http_error_try_now},success:!1}),!e.success)return jQuery(i).append("<p>"+e.data.message+"</p>"),confirm(e.data.message)?(a.current--,i.scrollTop(i[0].scrollHeight),!0):(jQuery(i).append(vgse_editor_settings.texts.saving_stop_error),i.scrollTop(i[0].scrollHeight),!1);e.data.force_complete&&(a.current=a.totalCalls),n.go(a.current/a.totalCalls*100),d+=e.data.created;var t=(t=e.data.message.replace("{total_created}",d)).replace("{total}",r);return jQuery(i).empty().append("<p>"+t+"</p>"),a.current===a.totalCalls&&(jQuery(i).append("<p>"+vgse_editor_settings.texts.everything_saved+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.everything_saved}),i.find(".remodal-cancel").removeClass("hidden"),o.find("#be-variations-nanobar-container").remove()),setTimeout(function(){i.scrollTop(i[0].scrollHeight)},600),!0}})}(i.find('input[name="wpse_job_id"]').val(),g,o):(jQuery(c).append("<p>"+vgse_editor_settings.texts.everything_saved+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.everything_saved}),c.find(".remodal-cancel").removeClass("hidden"),i.find("#be-variations-nanobar-container").remove()),d&&n&&(jQuery("body").data("be-filters",""),jQuery("body").data("be-filters",n))),setTimeout(function(){c.scrollTop(c[0].scrollHeight)},600),!0}})}else loading_ajax({estado:!0}),jQuery.ajax({url:i.attr("action"),method:i.attr("method"),data:t}).done(function(e){loading_ajax({estado:!1}),e.success?(1<e.data.data.length&&vgAddRowsToSheet(e.data.data,"prepend",!0),e.data.deleted.length&&vgseRemoveRowFromSheetByID(e.data.deleted),notification({mensaje:e.data.message}),jQuery(window).scrollTop(jQuery(".be-spreadsheet-wrapper").offset().top-jQuery("#vg-header-toolbar").height()-20)):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}),jQuery(".create-variation-modal").remodal().close()});return!1})}),jQuery(document).ready(function(){jQuery(".vgse-current-filters").on("click",".button",function(e){"wc_display_variations"!==jQuery(this).data("filter-key")&&!jQuery(this).hasClass("remove-all-filters")||jQuery("#display-variations").prop("checked",!jQuery("#display-variations").prop("checked")).trigger("change")}),jQuery('.vgse-current-filters .button[data-filter-key="wc_display_variations"]').length&&jQuery("#display-variations").prop("checked",!0).trigger("change"),jQuery('.vgse-current-filters .button[data-filter-key="search_variations"]').length&&jQuery('#be-filters input[name="search_variations"]').prop("checked",!0).trigger("change");var e=jQuery('.wpse-advanced-filters-field-selector option[value*="attribute_"]'),a=e.clone();e.remove(),jQuery('#be-filters input[name="search_variations"]').on("change",function(e){e.preventDefault(),jQuery(this).is(":checked")?(jQuery("#display-variations").prop("checked",!0).trigger("change"),jQuery(".wpse-advanced-filters-field-selector").append(a),jQuery(".modal-formula .run-on-variations-field select").is(":visible")||jQuery(".modal-formula .run-on-variations-field select").val("on"),jQuery('.wpse-advanced-filters-field-selector option[value*="attribute_"]').show(),jQuery('.wpse-advanced-filters-field-selector option[value*="attribute_pa_"]').hide()):(jQuery('.wpse-advanced-filters-field-selector option[value*="attribute_"]').hide(),jQuery(".modal-formula .run-on-variations-field select").is(":visible")||jQuery(".modal-formula .run-on-variations-field select").val(""))}),jQuery("#display-variations").on("change",function(e){var a=jQuery(this);a.is(":checked")?jQuery("body").addClass("vg-variations-enabled"):jQuery("body").removeClass("vg-variations-enabled");var t={wc_display_variations:a.is(":checked")?"yes":""};beAddRowsFilter(t)}),jQuery("#display-variations").on("click",function(e){var a=jQuery(this);if(beGetModifiedItems().length){if(a.is(":checked"))var t=vgse_wc_attr_data.texts.variations_on_reload_needed;else t=vgse_wc_attr_data.texts.variations_off_reload_needed;if(!confirm(t))return!0}a.trigger("change"),vgseReloadSpreadsheet()}),jQuery(".modal-formula .run-on-variations-field select").on("change",function(){var e=jQuery('#be-filters input[name="search_variations"]');e.prop("checked",!!jQuery(this).val()),e.trigger("change"),jQuery(this).val()?beAddRowsFilter("search_variations=yes"):beAddRowsFilter("search_variations="),window.wpseUpdateBulkEditRowsCount=!0,"current_search"===jQuery(".modal-formula .wpse-select-rows-options").val()&&jQuery("#be-filters").submit()})}),jQuery(document).ready(function(){jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,a){if(void 0===a.data.total_inventory_price||void 0===a.data.total_inventory_price)return!0;jQuery("#responseConsole .wc-inventory-totals .item-value").html(a.data.total_inventory_units+" units ("+a.data.total_inventory_price+")")})}),jQuery(document).ready(function(){var i=jQuery(".vgse-variations-tool-selector");i.on("click",function(e){e.preventDefault();var a=jQuery(this).data("target");jQuery(".vgse-variations-tool").hide(),i.removeClass("active"),jQuery(this).addClass("active");var t=jQuery(a);t.show();var r=t.find("select.select2");if(r.data("select2"))try{r.select2("destroy")}catch(e){}vgseInitSelect2(r.filter(function(){return jQuery(this).is(":visible")}))}),jQuery('[name="vgse_variation_manager_source"]').on("change",function(e){var a=jQuery(this).parents(".vgse-variations-tool"),t=jQuery(this).val();a.find(".use-search-query-container").hide(),a.find(".use-search-query-container").find("input:checkbox").prop("checked",!1),"search"===t?(a.find(".use-search-query-container").css("display","block"),a.find(".individual-product-selector").hide(),a.find(".individual-product-selector ~ .select2").hide(),window.vgseBackToVariationsTool=!0,jQuery('[name="run_filters"]').first().click()):"all"===t?(a.find(".use-search-query-container").hide(),a.find(".individual-product-selector").hide(),a.find(".use-search-query-container").find("input:checkbox").prop("checked",!0),a.find(".individual-product-selector ~ .select2").hide(),a.hasClass("vgse-create-variations")?(jQuery("body").data("be-filters",{"apply_to[]":"product_type--variable"}),vgseReloadSpreadsheet(!0)):vgseRemoveAllFilters()):("individual"===t&&(a.find(".individual-product-selector").show(),a.find(".individual-product-selector ~ .select2").show()),t||(a.find(".individual-product-selector").hide(),a.find(".individual-product-selector ~ .select2").hide()));var r=a.find("select.select2");vgseInitSelect2(r.filter(function(){return jQuery(this).is(":visible")}))}),jQuery(document).on("closed",'[data-remodal-id="modal-filters"]',function(){void 0!==window.vgseBackToVariationsTool&&window.vgseBackToVariationsTool&&(window.vgseBackToVariationsTool=!1,jQuery('[data-remodal-target="create-variation-modal"]').first().click())}),jQuery(".vgse-variations-tool .show-advanced-options").on("change",function(){jQuery(this).is(":checked")?jQuery(".vgse-variations-tool .advanced-options").show():jQuery(".vgse-variations-tool .advanced-options").hide()}),jQuery(document).on("closed",'[data-remodal-id="create-variation-modal"]',function(){jQuery('[data-remodal-id="create-variation-modal"]').find(".response").empty(),jQuery('[data-remodal-id="create-variation-modal"]').find("#be-variations-nanobar-container").remove();var e=jQuery(".vgse-variations-tool.vgse-copy-variations");"copy"===e.find('input[name="vgse_variation_tool"]').val()&&e.data("isPaginatedIndividualProductsOperation")&&e.find('[name="vgse_variation_manager_source"]').val("individual").trigger("change"),window.wpseCreateVariationsLoop&&window.wpseCreateVariationsLoop.pause(),window.wpseCopyVariationsQueueLoop&&window.wpseCopyVariationsQueueLoop.pause()})}),jQuery(document).ready(function(){if("undefined"==typeof hot||!jQuery(".create_variation-container").length)return!0;var e=hot.getSettings().contextMenu;void 0===e.items&&(e.items={}),e.items.wc_separator1={name:"---------"},e.items.wpse_create_variations={name:vgse_editor_settings.texts.create_variations,callback:function(e,a,t){if(beGetModifiedItems().length)alert(vgse_editor_settings.texts.save_changes_before_we_reload);else{var o=jQuery(".create-variation-modal .vgse-create-variations").find(".individual-product-selector");o.find("option").prop("selected",!1).trigger("change"),jQuery('select[name="vgse_variation_manager_source"]').val("individual").trigger("change");var n=[];a.forEach(function(e){for(var a=e.start.row>e.end.row?e.end.row:e.start.row,t=e.start.row>e.end.row?e.start.row:e.end.row,r=[],i=a;i<=t;i++)r.push(i);r.forEach(function(e){var a=parseInt(hot.getDataAtRowProp(e,"ID")),t=hot.getDataAtRowProp(e,"post_title"),r="product--"+a;n.push(r),o.find('option[value="'+r+'"]').length||o.append('<option value="'+r+'">'+t+"</option>")})}),o.val(n).trigger("change"),jQuery(".create_variation-container  button").click(),setTimeout(function(){jQuery('.create-variation-modal .vgse-variations-tool-selector[data-target=".vgse-create-variations"]').click()},800)}}},e.items.wpse_copy_variations={name:vgse_editor_settings.texts.copy_variations,callback:function(e,a,t){if(beGetModifiedItems().length)alert(vgse_editor_settings.texts.save_changes_before_we_reload);else{var r=parseInt(hot.getDataAtRowProp(a[0].start.row,"ID")),i=hot.getDataAtRowProp(a[0].start.row,"post_title"),o=jQuery(".create-variation-modal .vgse-copy-variations .vgse-copy-variation-from-product"),n="product--"+r;o.append('<option value="'+n+'">'+i+"</option>"),o.val(n).trigger("change"),jQuery(".create_variation-container  button").click(),setTimeout(function(){jQuery('.create-variation-modal .vgse-variations-tool-selector[data-target=".vgse-copy-variations"]').click()},800)}}},hot.updateSettings({contextMenu:e})});